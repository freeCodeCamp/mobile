(()=>{"use strict";const t=(t="/dist/")=>{const e=t.startsWith("/"),s=t.endsWith("/");return e||(t="/"+t),s||(t+="/"),t};class e{#t;#e;#s({assetPath:e,script:s}){const r=document.createElement("iframe");return r.sandbox.add("allow-scripts","allow-forms"),r.allow="autoplay",r.id="test-frame",{iframe:r,scriptHTML:`<script src='${t(e)+s}'><\/script>`}}constructor(t){const{scriptHTML:e,iframe:s}=this.#s(t);this.#t=s,this.#e=e}async init(t){const{hooks:e}=t,s=e?.beforeAll?`<script>\n${e.beforeAll}\n<\/script>`:"",r=new Promise((t=>{this.#t.addEventListener("load",(()=>{t(!0)}))}));this.#t.srcdoc=`\n${this.#e}\n${s}\n${t.source}`,document.body.appendChild(this.#t),await r;const a=new Promise((t=>{window.addEventListener("message",(e=>{"null"===e.origin&&e.source===this.#t.contentWindow&&"ready"===e.data.type&&t(!0)}))})),n={type:"init",value:t};this.#t.contentWindow?.postMessage(n,"*"),await a}runTest(t){const e=new Promise((t=>{window.addEventListener("message",(e=>{"null"===e.origin&&e.source===this.#t.contentWindow&&t(e.data.value)}))})),s={type:"test",value:t};return this.#t.contentWindow?.postMessage(s,"*"),e}dispose(){this.#t.remove()}}class s{#t;#s({assetPath:e,script:s}){const r=t(e)+s;return new Worker(r)}constructor(t){this.#t=this.#s(t)}async init(t){const e=new Promise((t=>{this.#t.onmessage=e=>{"ready"===e.data.type&&t(!0)}})),s={type:"init",value:t};this.#t.postMessage(s),await e}runTest(t){const e=new Promise((t=>{this.#t.onmessage=e=>{t(e.data.value)}})),s={type:"test",value:t};return this.#t.postMessage(s),e}dispose(){this.#t.terminate()}}window.FCCSandbox=new class{#r;#a;#n;constructor(){this.#r=null,this.#a=null,this.#n=null}getRunner(t){switch(t){case"frame":return this.#r;case"worker":return this.#a;case"python":return this.#n}}async createTestRunner({source:t,type:r,code:a,assetPath:n,hooks:o,loadEnzyme:i}){let u=null;switch(r){case"frame":this.#r||(this.#r=new e({assetPath:n,script:"frame-test-evaluator.js"})),u=this.#r;break;case"worker":this.#a||(this.#a=new s({assetPath:n,script:"worker-test-evaluator.js"})),u=this.#a;break;case"python":this.#n||(this.#n=new s({assetPath:n,script:"python-test-evaluator.js"})),u=this.#n}return await u.init({code:a,source:t,loadEnzyme:i,hooks:o}),u}}})();