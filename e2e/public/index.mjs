(()=>{"use strict";const t=(t="/dist/")=>{const e=t.startsWith("/"),s=t.endsWith("/");return e||(t="/"+t),s||(t+="/"),t};class e{#t;#e;#s({assetPath:e,script:s}){const a=document.createElement("iframe");return a.sandbox.add("allow-scripts"),a.allow="autoplay",a.id="test-frame",{iframe:a,scriptHTML:`<script src='${t(e)+s}'><\/script>`}}constructor(t){const{scriptHTML:e,iframe:s}=this.#s(t);this.#t=s,this.#e=e}async init(t){const{hooks:e}=t,s=e?.beforeAll?`<script>\n${e.beforeAll}\n<\/script>`:"",a=new Promise((t=>{this.#t.addEventListener("load",(()=>{t(!0)}))}));this.#t.srcdoc=`\n${this.#e}\n${s}\n${t.source}`,document.body.appendChild(this.#t),await a;const r=new Promise((t=>{window.addEventListener("message",(e=>{"null"===e.origin&&e.source===this.#t.contentWindow&&"ready"===e.data.type&&t(!0)}))})),n={type:"init",value:t};this.#t.contentWindow?.postMessage(n,"*"),await r}runTest(t){const e=new Promise((t=>{window.addEventListener("message",(e=>{"null"===e.origin&&e.source===this.#t.contentWindow&&t(e.data.value)}))})),s={type:"test",value:t};return this.#t.contentWindow?.postMessage(s,"*"),e}dispose(){this.#t.remove()}}class s{#t;#s({assetPath:e,script:s}){const a=t(e)+s;return new Worker(a)}constructor(t){this.#t=this.#s(t)}async init(t){const e=new Promise((t=>{this.#t.onmessage=e=>{"ready"===e.data.type&&t(!0)}})),s={type:"init",value:t};this.#t.postMessage(s),await e}runTest(t){const e=new Promise((t=>{this.#t.onmessage=e=>{t(e.data.value)}})),s={type:"test",value:t};return this.#t.postMessage(s),e}dispose(){this.#t.terminate()}}window.FCCSandbox=new class{#a;constructor(){this.#a=null}get testRunner(){return this.#a}async createTestRunner({source:t,type:a,code:r,assetPath:n,hooks:o,loadEnzyme:i}){switch(this.#a?.dispose(),a){case"frame":this.#a=new e({assetPath:n,script:"frame-test-evaluator.mjs"});break;case"worker":this.#a=new s({assetPath:n,script:"worker-test-evaluator.mjs"});break;case"python":this.#a=new s({assetPath:n,script:"python-test-evaluator.mjs"})}return await this.#a.init({code:r,source:t,loadEnzyme:i,hooks:o}),this.#a}}})();